REMEMBER TO UPDATE THE VERSION NUMBER!

--Rename a column AdsBlocked to AdsBlockedGoogle.
START TRANSACTION;
ALTER TABLE `Samples` CHANGE `AdsBlocked` `AdsBlockedGoogle` BOOL;
ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 10;
COMMIT;

--Add new column AdsBlockedBanner to table.
----This is an alternative way of doing this, this one involves widening the datatype so we can have a PREVIOUS_VERSION value.
----This was silly though because we can detect it's a previous version by looking at the version number
--START TRANSACTION;
--ALTER TABLE `Samples` ADD `AdsBlockedBanner` TINYINT(2) AFTER `AdsBlockedGoogle`;
--UPDATE  `Samples` SET `AdsBlockedBanner` = -1;
--ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 11;
--COMMIT;

--Add new column AdsBlockedBanner to table.
START TRANSACTION;
ALTER TABLE `Samples` ADD `AdsBlockedBanner` BOOL AFTER `AdsBlockedGoogle`;
ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 11;
COMMIT;

--Add new column AdsBlockedScript to table.
START TRANSACTION;
ALTER TABLE `Samples` ADD `AdsBlockedScript` BOOL AFTER `AdsBlockedBanner`;
ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 12;
COMMIT;

--Add new column ScreenDetailsCSS to table.
START TRANSACTION;
ALTER TABLE `Samples` ADD `ScreenDetailsCSS` TEXT AFTER `ScreenDetailsFlash`;
ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 13;
COMMIT;

--Add new column LikeShareFacebook to table.
START TRANSACTION;
ALTER TABLE `Samples` ADD `LikeShareFacebook` INTEGER AFTER `AdsBlockedScript`;
ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 14;
COMMIT;

--Add new column LikeShareTwitter to table.
START TRANSACTION;
ALTER TABLE `Samples` ADD `LikeShareTwitter` INTEGER AFTER `LikeShareFacebook`;
ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 15;
COMMIT;

--Add new column LikeShareReddit to table.
START TRANSACTION;
ALTER TABLE `Samples` ADD `LikeShareReddit` INTEGER AFTER `LikeShareTwitter`;
ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 16;
COMMIT;

--Add new column audio fingerprint stuff to table.
START TRANSACTION;
ALTER TABLE `Samples` ADD `AudioFingerprintPXI` TEXT AFTER `TouchStart`;
ALTER TABLE `Samples` ADD `AudioFingerprintPXIFullBuffer` TEXT AFTER `AudioFingerprintPXI`;
ALTER TABLE `Samples` ADD `AudioFingerprintNtVc` TEXT AFTER `AudioFingerprintPXIFullBuffer`;
ALTER TABLE `Samples` ADD `AudioFingerprintCC` TEXT AFTER `AudioFingerprintNtVc`;
ALTER TABLE `Samples` ADD `AudioFingerprintHybrid` TEXT AFTER `AudioFingerprintCC`;
ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 17;
COMMIT;

--Add new column FontsCSS to table.
START TRANSACTION;
ALTER TABLE `Samples` ADD `FontsCSS` TEXT AFTER `FontsJS_CSS`;
ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 18;
COMMIT;

--DO THIS AFTER YOU FIX THE FontsCSS TEST SO WE CAN DISCOUNT THE NULLS THAT WERE RECEIVED WHEN THE TEST WASN'T ACTIVE
START TRANSACTION;
ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 19;
COMMIT;

--ADD FINGERPRINT HASH COLUMN TO `Samples`.
START TRANSACTION;
ALTER TABLE `Samples` ADD `FingerprintHash` TEXT AFTER `BrowserprintVersion`;
ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 20;
COMMIT;

--SET EXISTING FINGERPRINTS TO THEIR HASH USING HashBrowserprintDB
--UPDATE FINGERPRINT HASH COLUMN TO BE NOT NULL.

--Add new column HstsEnabled to table.
START TRANSACTION;
ALTER TABLE `Samples` ADD `HstsEnabled` BOOL AFTER `SuperCookieUserData`;
ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 21;
COMMIT;

--Increment version number because we streamlined the CSS fonts test.
START TRANSACTION;
ALTER TABLE `Samples` MODIFY COLUMN `BrowserprintVersion` SMALLINT UNSIGNED NOT NULL DEFAULT 22;
COMMIT;

--Add indexes to (hopefully) speed up Browserprint
ALTER TABLE `Samples` ADD INDEX `FingerprintHash`(`FingerprintHash`(28)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `UserAgent`(`UserAgent`(200)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `AcceptHeaders` (`AcceptHeaders`(200)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `Platform` (`Platform`(40)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `PlatformFlash` (`PlatformFlash`(40)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `PluginDetails` (`PluginDetails`(800)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `TimeZone` (`TimeZone`(10)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `ScreenDetails` (`ScreenDetails`(20)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `ScreenDetailsFlash` (`ScreenDetailsFlash`(20)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `ScreenDetailsCSS` (`ScreenDetailsCSS`(20)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `LanguageFlash` (`LanguageFlash`(20)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `Fonts` (`Fonts`(2000)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `FontsJS_CSS` (`FontsJS_CSS`(500)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `FontsCSS` (`FontsCSS`(500)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `CharSizes` (`CharSizes`(4000)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `ClockDifference` (`ClockDifference`) USING HASH;
ALTER TABLE `Samples` ADD INDEX `DateTime` (`DateTime`(50)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `MathTan` (`MathTan`(20)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `TbbVersion` (`TbbVersion`(5)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `AdsBlocked` (`AdsBlockedGoogle`,`AdsBlockedBanner`,`AdsBlockedScript`) USING HASH;
ALTER TABLE `Samples` ADD INDEX `LikeShareDetails` (`LikeShareFacebook`,`LikeShareTwitter`,`LikeShareReddit`) USING HASH;
ALTER TABLE `Samples` ADD INDEX `Canvas` (`Canvas`(15000)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `WebGLVendor` (`WebGLVendor`(15)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `WebGLRenderer` (`WebGLRenderer`(30)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `TouchDetails` (`TouchPoints`,`TouchEvent`,`TouchStart`) USING HASH;
ALTER TABLE `Samples` ADD INDEX `AudioFingerprintPXI` (`AudioFingerprintPXI`(20)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `AudioFingerprintPXIFullBuffer` (`AudioFingerprintPXIFullBuffer`(40)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `AudioFingerprintNtVc` (`AudioFingerprintNtVc`(600)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `AudioFingerprintCC` (`AudioFingerprintCC`(600)) USING HASH;
ALTER TABLE `Samples` ADD INDEX `AudioFingerprintHybrid` (`AudioFingerprintHybrid`(600)) USING HASH;
